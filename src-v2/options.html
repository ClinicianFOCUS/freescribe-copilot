<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FreeScribe - Options</title>
    <link rel="stylesheet" href="bootstrap.css" />
    <link rel="stylesheet" href="fontawesom.min.css" />
    <link rel="stylesheet" href="main.css" />
    <script src="jquery-3.7.1.min.js"></script>
    <script src="jquery.validate.min.js"></script>
    <script src="bootstrap.bundle.min.js"></script>
  </head>
  <body class="free-scribe">
    <div class="options-container">
      <h1 class="mb-4">FreeScribe Configuration</h1>

      <form id="configForm">
        <div id="configSection">
          <h3>
            Transcription Settings
            <a
              href="https://github.com/ClinicianFOCUS/speech2text-container"
              target="_blank"
              class="help-icon"
              title="Help"
            >
              <i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                title="Click to visit the Speech 2 Text container documentation"
              ></i>
            </a>
          </h3>

          <!-- New checkbox for local transcription -->
          <div class="config-item form-check">
            <input
              type="checkbox"
              id="transcriptionLocal"
              name="transcriptionLocal"
              class="form-check-input"
            />
            <label for="transcriptionLocal" class="form-check-label">
              Use Local Transcription
            </label>
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enable this option to use local transcription."
            ></i>
          </div>

          <div class="transcriptionLocalSettings hidden">
            <div class="config-item">
              <label for="transcriptionLocalModel">Transcription Model:</label>
              <select
                id="transcriptionLocalModel"
                name="transcriptionLocalModel"
                class="form-select"
              >
                <!-- Options will be populated dynamically -->
              </select>
            </div>
          </div>

          <div
            class="transcriptionServerSettings config-item d-flex align-items-center"
          >
            <div class="me-2">
              <label for="transcriptionHost">Host:</label>&nbsp;<i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                data-placement="right"
                title="Enter the host URL for the transcription server."
              ></i>
              <input
                type="text"
                id="transcriptionHost"
                name="transcriptionHost"
                class="form-control"
                required
              />
            </div>
            <div class="me-2">
              <label for="transcriptionPort">Port:</label>
              &nbsp;
              <i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                data-placement="right"
                title="Enter the port number for the transcription server."
              ></i>
              <input
                type="number"
                id="transcriptionPort"
                name="transcriptionPort"
                class="form-control"
                min="0"
                max="65535"
                required
              />
            </div>
            <div class="me-2">
              <label for="transcriptionSecure">Is Secure Host?</label>
              &nbsp;<i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                data-placement="right"
                title="Select whether the transcription server uses a secure connection (HTTPS)."
              ></i>
              <select
                id="transcriptionSecure"
                name="transcriptionSecure"
                class="form-select"
              >
                <option value="1">Yes</option>
                <option value="0">No</option>
              </select>
            </div>
          </div>
          <div class="transcriptionServerSettings config-item">
            <label for="transcriptionApiKey"
              >Transcription Server API Key:</label
            >
            &nbsp;<i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enter the API key for accessing the transcription server."
            ></i>
            <input
              type="text"
              id="transcriptionApiKey"
              name="transcriptionApiKey"
              class="form-control"
            />
          </div>

          <h3 class="mt-4">
            Language Model Settings
            <a
              href="https://github.com/ClinicianFOCUS/local-llm-container"
              target="_blank"
              class="help-icon"
              title="Help"
            >
              <i
                data-toggle="tooltip"
                title="Click to visit the LLM documentation"
                class="fas fa-question-circle"
              ></i>
            </a>
          </h3>

          <!-- New checkbox for local LLM -->
          <div class="config-item form-check">
            <input
              type="checkbox"
              id="llmLocal"
              name="llmLocal"
              class="form-check-input"
            />
            <label for="llmLocal" class="form-check-label">
              Use Local LLM
            </label>
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enable this option to use local language model."
            ></i>
          </div>

          <div class="llmLocalSettings hidden">
            <div class="config-item">
              <label for="llmLocalModel">LLM Model:</label>
              <select
                id="llmLocalModel"
                name="llmLocalModel"
                class="form-select"
              >
                <!-- Options will be populated dynamically -->
              </select>
            </div>
          </div>

          <div class="llmServerSettings config-item d-flex align-items-center">
            <div class="me-2">
              <label for="llmHost">Host:</label>
              &nbsp;<i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                data-placement="right"
                title="Enter the host URL for the language model server."
              ></i>
              <input
                type="text"
                id="llmHost"
                name="llmHost"
                class="form-control"
                required
              />
            </div>
            <div class="me-2">
              <label for="llmPort">Port:</label>
              &nbsp;
              <i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                data-placement="right"
                title="Enter the port number for the language model server."
              ></i>
              <input
                type="number"
                id="llmPort"
                name="llmPort"
                class="form-control"
                min="0"
                max="65535"
                required
              />
            </div>
            <div class="me-2">
              <label for="llmSecure">Is Secure Host?</label>
              &nbsp;<i
                class="fas fa-question-circle"
                data-toggle="tooltip"
                data-placement="right"
                title="Select whether the language model server uses a secure connection (HTTPS)."
              ></i>
              <select id="llmSecure" name="llmSecure" class="form-select">
                <option value="1">Yes</option>
                <option value="0">No</option>
              </select>
            </div>
          </div>
            <div class="llmServerSettings config-item">
                <label for="llmApiKey">LLM Server API Key:</label>
                &nbsp;<i
                  class="fas fa-question-circle"
                  data-toggle="tooltip"
                  data-placement="right"
                  title="Enter the API key for accessing the language model server."
                ></i>
                <input
                  type="text"
                  id="llmApiKey"
                  name="llmApiKey"
                  class="form-control"
                />
            </div>
          <div class="llmServerSettings config-item">
            <label for="llmModel">LLM Model:</label>
            &nbsp;<i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enter the name of the language model to use."
            ></i>
            <input
              type="text"
              id="llmModel"
              name="llmModel"
              class="form-control"
              required
            />
          </div>
          <div class="config-item">
            <label for="llmContextBefore">LLM Context Before:</label>
            &nbsp;<i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enter the context to provide before the prompt for the language model."
            ></i>
            <textarea
              id="llmContextBefore"
              name="llmContextBefore"
              rows="3"
              class="form-control"
            ></textarea>
          </div>
          <div class="config-item">
            <label for="llmContextAfter">LLM Context After:</label>
            &nbsp;<i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enter the context to provide after the prompt for the language model."
            ></i>
            <textarea
              id="llmContextAfter"
              name="llmContextAfter"
              rows="3"
              class="form-control"
            ></textarea>
          </div>

          <h3 class="mt-4">Real-time Processing Settings</h3>
          <div class="config-item form-check">
            <input
              type="checkbox"
              id="realtimeToggle"
              name="realtimeToggle"
              class="form-check-input"
            />
            <label for="realtimeToggle" class="form-check-label"
              >Enable Real-time Processing</label
            >
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enable this option to process audio in real-time."
            ></i>
          </div>
          <div class="config-item">
            <label for="realtimeRecordingLength"
              >Realtime Recording Length (seconds):</label
            >
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Specify the length of time for real-time recording in seconds."
            ></i>
            <input
              type="number"
              id="realtimeRecordingLength"
              name="realtimeRecordingLength"
              class="form-control"
              min="1"
              required
            />
          </div>
          <div class="config-item">
            <label for="silenceThreshold">Silence Threshold: </label>
            <output id="sliderOutput"></output>&nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Set the threshold for silence detection."
            ></i>
            <div class="slider-container">
              <span>Min: 0.01</span>
              <input
                type="range"
                id="silenceThreshold"
                name="silenceThreshold"
                class="form-range"
                min="0.01"
                max="0.10"
                step="0.01"
                value="0.05"
              />
              <span>Max: 0.10</span>
            </div>
          </div>
          <div class="config-item">
            <label for="minSilenceDuration"
              >Minimum Silence Duration (ms):</label
            >
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Specify the minimum duration of silence in milliseconds."
            ></i>
            <input
              type="number"
              id="minSilenceDuration"
              name="minSilenceDuration"
              class="form-control"
              min="0"
              required
            />
          </div>

          <h3 class="mt-4">Logging Settings</h3>
          <div class="config-item form-check">
            <input
              type="checkbox"
              id="debugMode"
              name="debugMode"
              class="form-check-input"
            />
            <label for="debugMode" class="form-check-label"
              >Enable Debug Mode</label
            >
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enable this option to log debug information."
            ></i>
          </div>

          <h3 class="mt-4">Pre and Post Processing Settings</h3>

          <div class="config-item form-check">
            <input
              type="checkbox"
              id="preProcessing"
              name="preProcessing"
              class="form-check-input"
            />
            <label for="preProcessing" class="form-check-label">
              Enable Pre-Processing
            </label>
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enable this option to apply pre-processing to the input."
            ></i>
          </div>
          <div class="pre-processing-settings config-item">
            <label for="preProcessingPrompt">Pre-Processing Prompt:</label>
            <textarea
              id="preProcessingPrompt"
              name="preProcessingPrompt"
              rows="3"
              class="pre-processing-form form-control"
            ></textarea>
          </div>

          <div class="config-item form-check">
            <input
              type="checkbox"
              id="postProcessing"
              name="postProcessing"
              class="form-check-input"
            />
            <label for="postProcessing" class="form-check-label">
              Enable Post-Processing
            </label>
            &nbsp;
            <i
              class="fas fa-question-circle"
              data-toggle="tooltip"
              data-placement="right"
              title="Enable this option to apply post-processing to the output."
            ></i>
          </div>
          <div class="post-processing-settings config-item">
            <label for="postProcessingPrompt">Post-Processing Prompt:</label>
            <textarea
              id="postProcessingPrompt"
              name="postProcessingPrompt"
              rows="3"
              class="post-processing-form form-control"
            ></textarea>
          </div>

          <div class="mt-4 d-flex justify-content-end">
            <button type="submit" id="saveConfig" class="btn btn-primary me-3">
              Save
            </button>
            <button type="button" id="closeButton" class="btn btn-danger">
              Cancel
            </button>
          </div>
        </div>
      </form>

      <div class="mt-4 text-center">
        <p>
          For more information, visit the
          <a href="https://github.com/ClinicianFOCUS/FreeScribe" target="_blank"
            >FreeScribe Client</a
          >.
        </p>
      </div>
    </div>
    <script type="module" src="options.js"></script>
  </body>
</html>
